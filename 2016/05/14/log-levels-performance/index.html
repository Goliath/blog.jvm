<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Bitecode blog"><meta property="og:type" content="article"><meta property="og:image" content="https://bitecode.blog//img/bg_water.webp"><meta property="twitter:image" content="https://bitecode.blog//img/bg_water.webp"><meta name=title content="Log Levels Performance"><meta property="og:title" content="Log Levels Performance"><meta property="twitter:title" content="Log Levels Performance"><meta name=description content="Marcin Szlagor's blog about JVM technologies"><meta property="og:description" content="Marcin Szlagor's blog about JVM technologies"><meta property="twitter:description" content="Marcin Szlagor's blog about JVM technologies"><meta property="twitter:card" content="summary"><meta name=keyword content="JVM, java, openjdk, jdk, performance, profiling, debugging, speed, bytecode, software craftsmanship, design patterns, java speed, security"><link rel="shortcut icon" href=/img/favicon.ico><title>Log Levels Performance | Marcin Szlagor's blog on JVM technologies</title>
<link rel=canonical href=/2016/05/14/log-levels-performance/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>Bitecode blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/groovy/>groovy</a></li><li><a href=/categories/jvm/>jvm</a></li><li><a href=/categories/performance/>performance</a></li><li><a href=/categories/security/>security</a></li><li><a href=/categories/tips/>tips</a></li><li><a href=/about/>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/bg_water.webp)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>Log Levels Performance</h1><h2 class=subheading>'The deeper level of logs is, the less impact it will have' - we use to say. Well that’s not true.</h2><span class=meta>Posted by
Marcin
on
Saturday, May 14, 2016</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h2 id=problem>Problem</h2><p>Take an example with grails log.debug() call. Let’s say I want to log a very often executed code.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>Long sum <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>(</span><span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>1000</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>each</span> <span style=color:#ff79c6>{</span> number <span style=color:#ff79c6>-&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>++</span>sum
</span></span><span style=display:flex><span>    log<span style=color:#ff79c6>.</span><span style=color:#50fa7b>debug</span> <span style=color:#f1fa8c>&#34;Sum = ${sum}&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>I use log.debug so my information is logged only if my project configuration allows that. That way if we turn off DEBUG, the logged line should not affect application speed. But is that really true?</p><p>Let’s check if the logged value is really not accessed?
To do so we need to turn off DEBUG and modify the code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>Long sum <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>(</span><span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>1000</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>each</span> <span style=color:#ff79c6>{</span> number <span style=color:#ff79c6>-&gt;</span>
</span></span><span style=display:flex><span>    log<span style=color:#ff79c6>.</span><span style=color:#50fa7b>debug</span> <span style=color:#f1fa8c>&#34;Sum = ${++sum}&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>Well, after finishing the loop, sum value is 1000 - it was incremented even when information was not logged. That means that every time you log heavy operations like e.g. object.dump() - they will get executed, even if the log level is not suppose to show that line.</p><h2 id=solution>Solution</h2><p>Possible solution is to add condition before logging.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>Long sum <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>(</span><span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>1000</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>each</span> <span style=color:#ff79c6>{</span> number <span style=color:#ff79c6>-&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>log<span style=color:#ff79c6>.</span><span style=color:#50fa7b>debugEnabled</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        log<span style=color:#ff79c6>.</span><span style=color:#50fa7b>debug</span> <span style=color:#f1fa8c>&#34;Sum = ${++sum}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><h2 id=sum-up>Sum up</h2><p>Turns out that logged value is accessed even when information is not logged.
Keep that in mind since it may not only bring down performance of your application, it may be even a reason of a bug.</p><hr><ul class=pager><li class=previous><a href=/2016/05/01/hello-world/ data-toggle=tooltip data-placement=top title="Welcome to Bitecode Blog">&larr;
Previous Post</a></li><li class=next><a href=/2016/05/14/mysql-dump-large-database/ data-toggle=tooltip data-placement=top title="Dumping large MySQL database">Next
Post &rarr;</a></li></ul><div id=disqus-comment></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bitecode-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:marcin.szlagor@codeappeal.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/Goliath><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/marcinszlagor/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="Bitecode blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Bitecode blog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>